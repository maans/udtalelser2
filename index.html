<!DOCTYPE html>

<html lang="da">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<title>Elevudtalelser (statisk)</title>
<link href="app.css" rel="stylesheet"/>
</head>
<body>
<header class="topbar no-print">
<div class="brand" id="brandHome" title="G√• til Data & import">
<span class="dot"></span>
<span>Elevudtalelser</span>
</div>
<nav aria-label="Navigation" class="tabs">
<button class="tab" data-tab="k" id="tab-k" title="K-elever">üë§ <span>K-elever</span></button>
<button class="tab" data-tab="edit" id="tab-edit" title="Redig√©r">‚úçÔ∏è <span>Redig√©r</span></button>
<button class="tab" data-tab="set" id="tab-set" title="Indstillinger">‚öôÔ∏è <span>Indstillinger</span></button>
        <button class="tab tab-help" id="tab-help-top" title="Hj√¶lp">? <span>Hj√¶lp</span></button>
</nav>
<div class="status">
<span class="statusText" id="statusText"></span>
<button class="btn small no-print" id="btnReload">‚Üª Reload</button></div>
</header>
<main class="app">
<!-- K-elever -->
<section class="view" id="view-k">
<div class="viewHeader">
        <div class="viewTitleRow">
          <h1>K-elever</h1>
          <div class="row gap wrap" style="justify-content:flex-end">
            <div class="muted small" id="kHeaderInfo"></div>
            <button class="btn small no-print" id="btnPrintAllK" type="button" title="Print alle dine K-elever som √©n samlet udskrift">üñ®Ô∏è Print alle</button>
          </div>
        </div>
      </div>
<div class="callout" id="kMessage"></div>
<div class="list" id="kList"></div>
</section>
<!-- Redig√©r -->
<section class="view" id="view-edit">
<div class="viewHeader no-print">
<div class="viewTitleRow">
  <h1>Redig√©r</h1>
  <div class="pill muted" id="autosavePill"></div>
  <button class="btn no-print" id="btnPrint">üñ®Ô∏è Print / Gem som PDF</button>
</div>
<div class="row gap wrap">
  <div class="pill" id="editStudentPill">Ingen elev valgt</div>
</div>
</div>
<div class="callout no-print" id="editMessage">
  <div class="editNavRow no-print" id="editNavRow">
    <div class="navSlot left">
      <button class="btn small no-print" id="btnPrevStudent" type="button" title="Forrige elev">‚óÄ Forrige</button>
    </div>
    <div class="navSlot center"></div>
    <div class="navSlot right">
      <button class="btn small no-print" id="btnNextStudent" type="button" title="N√¶ste elev">N√¶ste ‚ñ∂</button>
    </div>
  </div>
  <div class="muted" id="editHint"></div>
</div>
<div class="split">
<div class="panel no-print">
<details class="fold" open="" id="secElevudv">
<summary>Udvikling <span class="secRatio" id="ratioElevudv"></span></summary>
<textarea id="txtElevudv" placeholder="Skriv udvikling‚Ä¶" rows="8"></textarea>
</details>
<details class="fold" id="secPraktisk">
<summary>Praktisk afsnit <span class="secRatio" id="ratioPraktisk"></span></summary>
<textarea id="txtPraktisk" placeholder="Skriv praktisk afsnit‚Ä¶" rows="7"></textarea>
</details>
<details class="fold" id="secKgruppe">
<summary>Funktion i kontaktgruppen <span class="secRatio" id="ratioKgruppe"></span></summary>
<textarea id="txtKgruppe" placeholder="Skriv kontaktgruppe-afsnit‚Ä¶" rows="7"></textarea>
</details>
<div class="card no-print">
<div class="cardTitle">Elevens eget input (PDF)</div>
<div class="row gap wrap">
  <input accept="application/pdf,.pdf" id="fileStudentInput" type="file" style="display:none" />
  <button class="btn" id="btnPickStudentPdf" type="button">V√¶lg PDF‚Ä¶</button>
  <button class="btn" id="btnOpenStudentInput" type="button" disabled>√Öbn i nyt vindue</button>
  <button class="btn ghost" id="btnClearStudentInput" type="button" disabled>Fjern</button>
  <div class="muted small" id="studentInputMeta"></div>
</div>
<div class="studentInputPreviewWrap" id="studentInputPreviewWrap" style="display:none;">
  <iframe id="studentInputPreview" title="Elevens eget input (PDF preview)"></iframe>
</div>
</div>
</div>
<div class="panel">
<article class="preview" id="preview"></article>
</div>
</div>
</section>
<!-- Indstillinger -->
<section class="view" id="view-set">
  <div class="viewHeader">
    <h1>Indstillinger</h1>
    <p class="muted">Alt gemmes lokalt i denne browser (localStorage). Ingen server.</p>
  </div>

  <div class="subtabs no-print" id="settingsSubtabs" role="tablist" aria-label="Indstillinger">
    <button class="subtab active" type="button" data-subtab="general" id="settingsTab-general">Generelt</button>
    <button class="subtab" type="button" data-subtab="data" id="settingsTab-data">Data &amp; import</button>
    <button class="subtab" type="button" data-subtab="export" id="settingsTab-export">Data &amp; eksport</button>
    <button class="subtab" type="button" data-subtab="texts" id="settingsTab-texts">Tekster / skabeloner</button>
    <button class="subtab" type="button" data-subtab="help" id="settingsTab-help">Hj√¶lp</button>
  </div>

  <!-- GENERELT -->
  <div class="settingsSubtab active" data-subtab="general" id="settingsSubtab-general">
    <div class="grid2">
      <div class="card">
        <div class="cardTitle">Identitet</div>
        <div class="field">
          <label>K-l√¶rer (initialer eller navn)</label>
          <div class="teacherPicker" id="teacherPicker">
            <input id="meInput" placeholder="fx MM, RD, MTP eller fuldt navn" type="text" autocomplete="off"/>
            <button class="tpBtn" id="teacherPickerBtn" type="button" aria-label="Vis liste">
              ‚ñæ
            </button>
            <div class="tpMenu" id="teacherPickerMenu" role="listbox" aria-label="V√¶lg K-l√¶rer" hidden></div>
          </div>
          <div class="muted small">Fortolkes via alias-map og bruges til filter af K-elever.</div>
        </div>
      </div>

      <div class="card">
        <div class="cardTitle">Periode</div>
        <div class="grid2 tight">
          <div class="field">
            <label>Skole√•r (slut-√•r)</label>
            <input id="schoolYearEnd" type="number" min="2020" max="2100"/>
          </div>
          <div class="field">
            <label>Kontaktgruppe antal (auto)</label>
            <input id="contactCount" type="text" readonly/>
          </div>
          <div class="field">
            <label>Periode fra (auto)</label>
            <input id="periodFrom" readonly type="text"/>
          </div>
          <div class="field">
            <label>Dato m√•ned/√•r (auto)</label>
            <input id="dateMonthYear" readonly type="text"/>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- DATA -->
  <div class="settingsSubtab" data-subtab="data" id="settingsSubtab-data">
    <div class="card">
      <div class="callout no-print" style="margin-top:.6rem">
        <div class="cardSubTitle" style="margin:0 0 .4rem 0">Gendan backup</div>
        <div class="muted small" style="margin-bottom:.6rem">V√¶lg en tidligere backup-JSON for at gendanne alt lokalt indhold.</div>
        <div class="row gap wrap">
          <label class="btn" for="backupFileInput" title="V√¶lg backupfil">‚¨ÜÔ∏è Gendan backup</label>
          <input type="file" id="backupFileInput" accept="application/json" style="display:none" />
        </div>
      </div>
      <button class="btn danger" id="btnReset" type="button">‚ö†Ô∏è Ryd alle lokale data (denne browser)</button>
      <div class="muted small" style="margin:.5rem 0 1rem 0">
        Sletter alle n√∏gler der starter med <code>udt_</code> og genstarter appen.
      </div>

      <div class="cardSubTitle">Elevliste (CSV) ‚Äì skal indl√¶ses f√∏rst</div>
      <input accept=".csv,.txt" id="studentsFile" type="file"/>
      <div class="muted small" id="studentsStatus" style="margin-top:.35rem"></div>

      <details class="fold no-print" style="margin-top:.8rem">
        <summary>Accepterede kolonner (eksempler)</summary>
        <div class="muted small">
          <div><b>Prim√¶rt:</b> Fornavn, Efternavn, Unilogin, K√∏n, Kontaktl√¶rer1, Kontaktl√¶rer2, Klasse</div>
          <div><b>Uni-C:</b> Klasse, Fornavn, Efternavn, Uni-C brugernavn, Relationer-Kontaktl√¶rer-Navn, Relationer-Anden kontaktl√¶rer-Navn</div>
          <div>Appen mapper kolonner robust (case-insensitivt, trim, accepter Unilogin/Uni-C brugernavn).</div>
        </div>
      </details>

      <div class="divider"></div>

      <div class="cardSubTitle">Import af fagl√¶rer-CSV‚Äôer (for kontaktl√¶rere)</div>
      <div class="grid3">
        <div class="field">
          <label>sang_marks.csv</label>
          <input accept=".csv,.txt" id="importSang" type="file"/>
        </div>
        <div class="field">
          <label>gym_marks.csv</label>
          <input accept=".csv,.txt" id="importGym" type="file"/>
        </div>
        <div class="field">
          <label>elevraad_marks.csv</label>
          <input accept=".csv,.txt" id="importElevraad" type="file"/>
        </div>
      </div>

      <div class="divider"></div>
    </div>
  </div>

  <!-- DATA & EKSPORT (FAGL√ÜRERE) -->
  <div class="settingsSubtab" data-subtab="export" id="settingsSubtab-export">
    <div class="card no-print">
      <div class="cardTitle">Data &amp; eksport (fagl√¶rere)</div>
      <div class="row gap wrap" style="margin:.5rem 0 .9rem 0; align-items:center">
        <button class="btn ghost" id="btnBackupDownload" type="button" title="Download backup af alle lokale data">‚¨áÔ∏è Backup (download)</button>
        <div class="muted small">Backup gemmer alt lokalt indhold (udtalelser, indstillinger, elevliste osv.) som en JSON-fil.</div>
      </div>
      <div class="muted small" style="margin:.35rem 0 .9rem 0">
        Her kan sang-/gymnastik-/elevr√•dsfagl√¶rere s√¶tte flueben og eksportere en CSV, som kontaktl√¶rerne kan importere.
      </div>
      <div class="row gap wrap">
        <div class="field" style="min-width: 260px">
          <div class="tabs small" id="marksTypeTabs">
            <!-- data-type values are internal codes used by app.js -->
            <button type="button" class="tab" data-type="sang">Sang</button>
            <button type="button" class="tab" data-type="gym">Gymnastik</button>
            <button type="button" class="tab" data-type="elevraad">Elevr√•d</button>
          </div>
          <select id="marksType" style="display:none">
            <option value="sang">Sang</option>
            <option value="gym">Gymnastik</option>
            <option value="elevraad">Elevr√•d</option>
          </select>
        </div>
        <div class="field" style="flex:1; min-width: 260px">
          <label>Find elev</label>
          <input id="marksSearch" type="text" placeholder="S√∏g i navn eller Uni-login"/>
        </div>
        <div class="field" style="min-width: 200px">
          <label>&nbsp;</label>
          <button class="btn" id="btnExportMarks" type="button">‚¨áÔ∏è Eksport√©r CSV</button>
        </div>
      </div>

      
      <div class="divider"></div>
      <div class="cardSubTitle">Backup (valgfrit ‚Äì til sikkerhed)</div>
      <div class="row gap wrap" style="align-items:center">
        <div class="muted small" style="flex:1; min-width:260px">Downloader en kopi af alt lokalt gemt i denne browser (udtalelser, flueben, skabeloner m.m.).</div>
        </div>

      <div class="muted small" id="marksLegend" style="margin:.35rem 0 .6rem 0"></div>
      <div id="marksTableWrap"></div>
    </div>
  </div>

  <div class="settingsSubtab" data-subtab="texts" id="settingsSubtab-texts">
    <div class="grid2">
      <div class="card">
        <div class="cardTitle">Skole og skabelon</div>

        <div class="field">
          <label>Forstandernavn</label>
          <div class="row gap">
            <input id="forstanderName" type="text"/>
            <button class="btn ghost" id="btnToggleForstander" title="L√•s op / l√•s" type="button">‚úèÔ∏è</button>
          </div>
        </div>

        <details class="fold" id="schoolTextFold">
          <summary>Skolens standardtekst</summary>
          <div class="row gap wrap" style="margin:.5rem 0">
            <button class="btn ghost" id="btnToggleSchoolText" type="button">‚úèÔ∏è Redig√©r</button>
            <button class="btn ghost" id="btnRestoreSchoolText" type="button">‚Ü©Ô∏è Gendan standard</button>
          </div>
          <textarea id="schoolText" rows="10"></textarea>
        </details>

        <details class="fold" id="templateFold">
          <summary>Udtalelses-skabelon (med placeholders)</summary>
          <div class="row gap wrap" style="margin:.5rem 0">
            <button class="btn ghost" id="btnToggleTemplate" type="button">‚úèÔ∏è Redig√©r</button>
            <button class="btn ghost" id="btnRestoreTemplate" type="button">‚Ü©Ô∏è Gendan standard</button>
          </div>
          <textarea id="templateText" rows="14"></textarea>
          <div class="muted small">Brug placeholders som <code>{{ELEV_FORNAVN}}</code>, <code>{{SANG_AFSNIT}}</code>, <code>{{PRAKTISK_AFSNIT}}</code> osv.</div>
        </details>

        <details class="fold" id="templatesShareFold">
          <summary>Del / import√©r skabeloner (leder)</summary>
          <div class="muted small" style="margin:.35rem 0 .6rem 0">
            G√¶lder <b>Forstandernavn</b>, <b>Skolens standardtekst</b> og <b>Udtalelses-skabelon</b>. Download filen og del den med kolleger.
          </div>
          <div class="row gap wrap" style="margin:.5rem 0">
            <button class="btn" id="btnExportTemplates" type="button">‚¨áÔ∏è Download skabeloner</button>
            <button class="btn ghost" id="btnImportTemplates" type="button">‚¨ÜÔ∏è Import√©r skabeloner</button>
            <input id="fileImportTemplates" type="file" accept=".json" style="display:none"/>
          </div>
        </details>
      </div>

      <div class="card no-print">
        <div class="cardTitle">Fagl√¶rer-tekster (snippets)</div>
        <div class="muted small" style="margin-bottom:.5rem">
          Redig√©r tekster direkte her. N√•r du klikker ‚ÄúDownload √¶ndringer‚Äù, f√•r du en fil du kan sende til M√•ns.
        </div>

        <details open>
          <summary><b>Sang</b> (3 niveauer)</summary>
          <div class="row gap wrap" style="margin:.5rem 0">
            <button class="btn" id="btnDownloadSang" type="button">‚¨áÔ∏è Download √¶ndringer</button>
            <button class="btn ghost" id="btnImportSang" type="button">‚¨ÜÔ∏è Import√©r √¶ndringer</button>
            <button class="btn ghost" id="btnRestoreSang" type="button">‚Ü©Ô∏è Gendan standard</button>
            <input id="fileImportSang" type="file" accept=".json" style="display:none"/>
          </div>

          <div class="field">
            <label>Niveau 1 ‚Äì titel</label>
            <input id="sangLabel_S1" type="text"/>
          </div>
          <div class="field">
            <label>Niveau 1 ‚Äì tekst</label>
            <textarea id="sangText_S1" rows="4"></textarea>
          </div>

          <div class="field">
            <label>Niveau 2 ‚Äì titel</label>
            <input id="sangLabel_S2" type="text"/>
          </div>
          <div class="field">
            <label>Niveau 2 ‚Äì tekst</label>
            <textarea id="sangText_S2" rows="4"></textarea>
          </div>

          <div class="field">
            <label>Niveau 3 ‚Äì titel</label>
            <input id="sangLabel_S3" type="text"/>
          </div>
          <div class="field">
            <label>Niveau 3 ‚Äì tekst</label>
            <textarea id="sangText_S3" rows="4"></textarea>
          </div>
        </details>

        <details>
          <summary><b>Gymnastik</b> (3 niveauer + roller)</summary>
          <div class="row gap wrap" style="margin:.5rem 0">
            <button class="btn" id="btnDownloadGym" type="button">‚¨áÔ∏è Download √¶ndringer</button>
            <button class="btn ghost" id="btnImportGym" type="button">‚¨ÜÔ∏è Import√©r √¶ndringer</button>
            <button class="btn ghost" id="btnRestoreGym" type="button">‚Ü©Ô∏è Gendan standard</button>
            <input id="fileImportGym" type="file" accept=".json" style="display:none"/>
          </div>

          <div class="field">
            <label>Niveau 1 ‚Äì titel</label>
            <input id="gymLabel_G1" type="text"/>
          </div>
          <div class="field">
            <label>Niveau 1 ‚Äì tekst</label>
            <textarea id="gymText_G1" rows="4"></textarea>
          </div>

          <div class="field">
            <label>Niveau 2 ‚Äì titel</label>
            <input id="gymLabel_G2" type="text"/>
          </div>
          <div class="field">
            <label>Niveau 2 ‚Äì tekst</label>
            <textarea id="gymText_G2" rows="4"></textarea>
          </div>

          <div class="field">
            <label>Niveau 3 ‚Äì titel</label>
            <input id="gymLabel_G3" type="text"/>
          </div>
          <div class="field">
            <label>Niveau 3 ‚Äì tekst</label>
            <textarea id="gymText_G3" rows="4"></textarea>
          </div>

          <div class="divider"></div>
          <div class="cardSubTitle">Roller</div>
          <div id="gymRolesList"></div>
        </details>

        <details>
          <summary><b>Elevr√•d</b></summary>
          <div class="row gap wrap" style="margin:.5rem 0">
            <button class="btn" id="btnDownloadElevraad" type="button">‚¨áÔ∏è Download √¶ndringer</button>
            <button class="btn ghost" id="btnImportElevraad" type="button">‚¨ÜÔ∏è Import√©r √¶ndringer</button>
            <button class="btn ghost" id="btnRestoreElevraad" type="button">‚Ü©Ô∏è Gendan standard</button>
            <input id="fileImportElevraad" type="file" accept=".json" style="display:none"/>
          </div>

          <div class="field">
            <label>Tekst</label>
            <textarea id="elevraadText" rows="6"></textarea>
          </div>
        </details>
      </div>
    </div>
  </div>

  <!-- HJ√ÜLP -->
  <div class="settingsSubtab" data-subtab="help" id="settingsSubtab-help">
        <div class="card">
          <h2>Hj√¶lp (hvem g√∏r hvad og i hvilken r√¶kkef√∏lge?)</h2>
          <p class="muted">S√•dan bruger vi appen sammen:</p>
          <ol class="helpList">
            <li><strong>Alle:</strong> G√• til <a href="#" class="helpLink" data-goto="set:data">Indstillinger ‚Üí Data &amp; import</a> og upload <code>students.csv</code> (elevlisten).</li>
            <li><strong>Kontaktl√¶rer:</strong> Under <a href="#" class="helpLink" data-goto="set:general">Generelt</a> skriv dit <strong>K-l√¶rer-navn / initialer</strong> og brug <a href="#" class="helpLink" data-goto="k">K-elever</a> til at redigere dine elever.</li>
            <li><strong>Sang-/Gymnastik-/Elevr√•dsl√¶rere:</strong> G√• til <a href="#" class="helpLink" data-goto="set:export">Indstillinger ‚Üí Data &amp; eksport</a>, v√¶lg fanen og s√¶t krydser. Eksport√©r CSV og send den til kontaktl√¶rerne.</li>
            <li><strong>Kontaktl√¶rer:</strong> Import√©r de 3 CSV‚Äôer under <a href="#" class="helpLink" data-goto="set:data">Data &amp; import</a>. (De bruges i udtalelses-skabelonen og kan ses i <a href="#" class="helpLink" data-goto="edit">Redig√©r</a>.)</li>
            <li><strong>Til sidst:</strong> G√• til <a href="#" class="helpLink" data-goto="edit">Redig√©r</a> og brug Print / Gem som PDF.</li>
            <li><strong>Hvis tekster/skabeloner skal opdateres:</strong> G√• til <a href="#" class="helpLink" data-goto="set:texts">Tekster / skabeloner</a>. Redig√©r, download og del med M√•ns, hvis appen skal opdateres for alle.</li>
          </ol>

          <div class="helpTip">
            <p class="muted"><strong>Tip:</strong> Alt gemmes lokalt i denne browser (localStorage). N√•r du rydder lokale data, forsvinder alt lokalt gemt ‚Äì s√• lav backup f√∏rst.</p>
          </div>
        </div>
      </div>
</section>
</main>
<footer class="footer no-print">
  <span class="muted small">Systemering af udtalelsesskrivning ¬∑ MM 2026</span>
</footer>

<!-- (K-l√¶rer) ‚Äì custom dropdown bygges i app.js -->

<script src="app.js"></script>
</body>
</html>